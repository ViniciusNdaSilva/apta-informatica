!function(e){var o,t,a,s,i,n,c,r,d,l,v,u,b,p,m,f,h,g,k,x,y,w,C,_,E,M,B,P;e.fn.extend({venobox:function(T){var Y=this,O=e.extend({arrowsColor:"#B6B6B6",autoplay:!1,bgcolor:"#fff",border:"0",closeBackground:"#161617",closeColor:"#d2d2d2",framewidth:"",frameheight:"",infinigall:!1,htmlClose:"&times;",htmlNext:"<span>Next</span>",htmlPrev:"<span>Prev</span>",numeratio:!1,numerationBackground:"#161617",numerationColor:"#d2d2d2",numerationPosition:"top",overlayClose:!0,overlayColor:"rgba(23,23,23,0.85)",spinner:"double-bounce",spinColor:"#d2d2d2",titleattr:"title",titleBackground:"#161617",titleColor:"#d2d2d2",titlePosition:"top",cb_pre_open:function(){return!0},cb_post_open:function(){},cb_pre_close:function(){return!0},cb_post_close:function(){},cb_post_resize:function(){},cb_after_nav:function(){},cb_init:function(){}},T);return O.cb_init(Y),this.each((function(){function T(){x=B.data("gall"),f=B.data("numeratio"),u=B.data("infinigall"),b=e('.vbox-item[data-gall="'+x+'"]'),y=b.eq(b.index(B)+1),w=b.eq(b.index(B)-1),b.length>1?(P=b.index(B)+1,a.html(P+" / "+b.length)):P=1,!0===f?a.show():a.hide(),""!==k?s.show():s.hide(),y.length||!0===u?(e(".vbox-next").css("display","block"),C=!0):(e(".vbox-next").css("display","none"),C=!1),b.index(B)>0||!0===u?(e(".vbox-prev").css("display","block"),_=!0):(e(".vbox-prev").css("display","none"),_=!1),(!0===_||!0===C)&&(c.on(TouchMouseEvent.DOWN,U),c.on(TouchMouseEvent.MOVE,V),c.on(TouchMouseEvent.UP,z))}function X(e){return!(e.length<1)&&(!p&&(p=!0,h=e.data("overlay")||e.data("overlaycolor"),l=e.data("framewidth"),v=e.data("frameheight"),i=e.data("border"),t=e.data("bgcolor"),r=e.data("href")||e.attr("href"),o=e.data("autoplay"),k=e.attr(e.data("titleattr"))||"",e===w&&c.addClass("animated").addClass("swipe-right"),e===y&&c.addClass("animated").addClass("swipe-left"),void c.animate({opacity:0},500,(function(){g.css("background",h),c.removeClass("animated").removeClass("swipe-left").removeClass("swipe-right").css({"margin-left":0,"margin-right":0}),"iframe"==e.data("vbtype")?j():"inline"==e.data("vbtype")?$():"ajax"==e.data("vbtype")?R():"video"==e.data("vbtype")||"vimeo"==e.data("vbtype")||"youtube"==e.data("vbtype")?W(o):(c.html('<img src="'+r+'">'),q()),B=e,T(),p=!1,O.cb_after_nav(B,P,y,w)}))))}function D(e){27===e.keyCode&&N(),37==e.keyCode&&!0===_&&X(w),39==e.keyCode&&!0===C&&X(y)}function N(){return!1!==O.cb_pre_close(B,P,y,w)&&(e("body").off("keydown",D).removeClass("vbox-open"),B.focus(),void g.animate({opacity:0},500,(function(){g.remove(),p=!1,O.cb_post_close()})))}function U(e){c.addClass("animated"),startY=e.pageY,Q=e.pageX,startouch=!0}function V(e){if(!0===startouch){S=e.pageX,endY=e.pageY,diffX=S-Q,diffY=endY-startY;var o=Math.abs(diffX);o>Math.abs(diffY)&&100>=o&&(e.preventDefault(),c.css("margin-left",diffX))}}function z(e){if(!0===startouch){startouch=!1;var o=B,t=!1;0>(Z=S-Q)&&!0===C&&(o=y,t=!0),Z>0&&!0===_&&(o=w,t=!0),Math.abs(Z)>=F&&!0===t?X(o):c.css({"margin-left":0,"margin-right":0})}}function R(){e.ajax({url:r,cache:!1}).done((function(e){c.html('<div class="vbox-inline">'+e+"</div>"),q()})).fail((function(){c.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),I()}))}function j(){c.html('<iframe class="venoframe" src="'+r+'"></iframe>'),I()}function W(e){var o,t=function(e){if(e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),RegExp.$3.indexOf("youtu")>-1)var o="youtube";else if(RegExp.$3.indexOf("vimeo")>-1)o="vimeo";return{type:o,id:RegExp.$6}}(r),a=(e?"?rel=0&autoplay=1":"?rel=0")+function(e){var o="",t=decodeURIComponent(e).split("?");if(void 0!==t[1]){var a,s,i=t[1].split("&");for(s=0;s<i.length;s++)o=o+"&"+(a=i[s].split("="))[0]+"="+a[1]}return encodeURI(o)}(r);"vimeo"==t.type?o="https://player.vimeo.com/video/":"youtube"==t.type&&(o="https://www.youtube.com/embed/"),c.html('<iframe class="venoframe vbvid" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="'+o+t.id+a+'"></iframe>'),I()}function $(){c.html('<div class="vbox-inline">'+e(r).html()+"</div>"),I()}function q(){images=c.find("img"),images.length?images.each((function(){e(this).one("load",(function(){I()}))})):I()}function I(){s.html(k),c.find(">:first-child").addClass("figlio").css({width:l,height:v,padding:i,background:t}),e("img.figlio").on("dragstart",(function(e){e.preventDefault()})),A(),c.animate({opacity:"1"},"slow",(function(){}))}function A(){var o=c.outerHeight(),t=e(window).height();t>o+60?(m=(t-o)/2,c.css("margin-top",m),c.css("margin-bottom",m)):(m="30px",c.css("margin-top",m),c.css("margin-bottom",m)),O.cb_post_resize()}if((B=e(this)).data("venobox"))return!0;Y.VBclose=function(){N()},B.addClass("vbox-item"),B.data("framewidth",O.framewidth),B.data("frameheight",O.frameheight),B.data("border",O.border),B.data("bgcolor",O.bgcolor),B.data("numeratio",O.numeratio),B.data("infinigall",O.infinigall),B.data("overlaycolor",O.overlayColor),B.data("titleattr",O.titleattr),B.data("venobox",!0),B.on("click",(function(u){if(u.preventDefault(),B=e(this),!1===O.cb_pre_open(B))return!1;switch(Y.VBnext=function(){X(y)},Y.VBprev=function(){X(w)},h=B.data("overlay")||B.data("overlaycolor"),l=B.data("framewidth"),v=B.data("frameheight"),o=B.data("autoplay")||O.autoplay,i=B.data("border"),t=B.data("bgcolor"),C=!1,_=!1,p=!1,r=B.data("href")||B.attr("href"),d=B.data("css")||"",k=B.attr(B.data("titleattr"))||"",E='<div class="vbox-preloader">',O.spinner){case"rotating-plane":E+='<div class="sk-rotating-plane"></div>';break;case"double-bounce":E+='<div class="sk-double-bounce"><div class="sk-child sk-double-bounce1"></div><div class="sk-child sk-double-bounce2"></div></div>';break;case"wave":E+='<div class="sk-wave"><div class="sk-rect sk-rect1"></div><div class="sk-rect sk-rect2"></div><div class="sk-rect sk-rect3"></div><div class="sk-rect sk-rect4"></div><div class="sk-rect sk-rect5"></div></div>';break;case"wandering-cubes":E+='<div class="sk-wandering-cubes"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div></div>';break;case"spinner-pulse":E+='<div class="sk-spinner sk-spinner-pulse"></div>';break;case"three-bounce":E+='<div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div>';break;case"cube-grid":E+='<div class="sk-cube-grid"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div></div>'}return E+="</div>",M='<a class="vbox-next">'+O.htmlNext+'</a><a class="vbox-prev">'+O.htmlPrev+"</a>",vbheader='<div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">'+O.htmlClose+"</div>",n='<div class="vbox-overlay '+d+'" style="background:'+h+'">'+E+'<div class="vbox-container"><div class="vbox-content"></div></div>'+vbheader+M+"</div>",e("body").append('<div class="ghostoverlay"></div>').append(n).addClass("vbox-open"),e(".vbox-preloader .sk-child, .vbox-preloader .sk-rotating-plane, .vbox-preloader .sk-rect, .vbox-preloader .sk-cube, .vbox-preloader .sk-spinner-pulse").css("background-color",O.spinColor),g=e(".vbox-overlay"),e(".vbox-container"),c=e(".vbox-content"),a=e(".vbox-num"),(s=e(".vbox-title")).css(O.titlePosition,"-1px"),s.css({color:O.titleColor,"background-color":O.titleBackground}),e(".vbox-close").css({color:O.closeColor,"background-color":O.closeBackground}),e(".vbox-num").css(O.numerationPosition,"-1px"),e(".vbox-num").css({color:O.numerationColor,"background-color":O.numerationBackground}),e(".vbox-next span, .vbox-prev span").css({"border-top-color":O.arrowsColor,"border-right-color":O.arrowsColor}),c.html(""),c.css("opacity","0"),T(),g.animate({opacity:1},250,(function(){"iframe"==B.data("vbtype")?j():"inline"==B.data("vbtype")?$():"ajax"==B.data("vbtype")?R():"video"==B.data("vbtype")||"vimeo"==B.data("vbtype")||"youtube"==B.data("vbtype")?W(o):(c.html('<img src="'+r+'">'),q()),O.cb_post_open(B,P,y,w)})),e("body").keydown(D),e(".vbox-prev").on("click",(function(){X(w)})),e(".vbox-next").on("click",(function(){X(y)})),!1}));var H=".vbox-overlay";O.overlayClose||(H=".vbox-close"),e(document).on("click",H,(function(o){(e(o.target).is(".vbox-overlay")||e(o.target).is(".vbox-content")||e(o.target).is(".vbox-close")||e(o.target).is(".vbox-preloader"))&&N()}));var Q=null,S=null,Z=0,F=50;startouch=!1,TouchMouseEvent={DOWN:"touchmousedown",UP:"touchmouseup",MOVE:"touchmousemove"};var G=function(o){var t;switch(o.type){case"mousedown":t=TouchMouseEvent.DOWN;break;case"mouseup":case"mouseout":t=TouchMouseEvent.UP;break;case"mousemove":t=TouchMouseEvent.MOVE;break;default:return}var a=K(t,o,o.pageX,o.pageY);e(o.target).trigger(a)},J=function(o){var t;switch(o.type){case"touchstart":t=TouchMouseEvent.DOWN;break;case"touchend":t=TouchMouseEvent.UP;break;case"touchmove":t=TouchMouseEvent.MOVE;break;default:return}var a,s=o.originalEvent.touches[0];a=t==TouchMouseEvent.UP?K(t,o,null,null):K(t,o,s.pageX,s.pageY),e(o.target).trigger(a)},K=function(o,t,a,s){return e.Event(o,{pageX:a,pageY:s,originalEvent:t})};"ontouchstart"in window?(e(document).on("touchstart",J),e(document).on("touchmove",J),e(document).on("touchend",J)):(e(document).on("mousedown",G),e(document).on("mouseup",G),e(document).on("mouseout",G),e(document).on("mousemove",G)),e(window).resize((function(){e(".vbox-content").length&&setTimeout(A(),800)}))}))}})}(jQuery);